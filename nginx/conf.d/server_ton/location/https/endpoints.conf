# API endpoints - strict rate limiting
location /api/ {
    limit_req zone=api burst=5 nodelay;
    limit_conn conn_limit_per_ip 3;
    proxy_pass http://webapp;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

}


# Mini App entry point - specific handling
location /app {
    limit_req zone=general burst=10 nodelay;
    limit_conn conn_limit_per_ip 5;
    proxy_pass http://webapp/app;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

}

# Mini App pages - general rate limiting
location / {
    limit_req zone=general burst=10 nodelay;
    limit_conn conn_limit_per_ip 5;
    proxy_pass http://webapp;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}